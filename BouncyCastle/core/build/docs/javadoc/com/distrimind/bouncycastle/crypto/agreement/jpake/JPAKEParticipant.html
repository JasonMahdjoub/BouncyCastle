<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="fr">
<head>
<!-- Generated by javadoc -->
<title>JPAKEParticipant (core 1.66-DMRECOMPILE API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: com.distrimind.bouncycastle.crypto.agreement.jpake, class: JPAKEParticipant">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../script-dir/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../../script-dir/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../../../script-dir/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../../../script-dir/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../../../script-dir/jquery-3.4.1.js"></script>
<script type="text/javascript" src="../../../../../../script-dir/jquery-ui.js"></script>
</head>
<body class="class-declaration">
<script type="text/javascript">var data = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<div class="navListSearch"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<a id="skip.navbar.top">
<!--   -->
</a>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">com.distrimind.bouncycastle.crypto.agreement.jpake</a></div>
<h1 title="Class JPAKEParticipant" class="title">Class JPAKEParticipant</h1>
</div>
<div class="contentContainer">
<div class="inheritance" title="Inheritance Tree">java.lang.Object
<div class="inheritance">com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKEParticipant</div>
</div>
<section class="description">
<hr>
<pre>public class <span class="typeNameLabel">JPAKEParticipant</span>
extends java.lang.Object</pre>
<div class="block">A participant in a Password Authenticated Key Exchange by Juggling (J-PAKE) exchange.
 <p>
 The J-PAKE exchange is defined by Feng Hao and Peter Ryan in the paper
 <a href="http://grouper.ieee.org/groups/1363/Research/contributions/hao-ryan-2008.pdf">
 "Password Authenticated Key Exchange by Juggling, 2008."</a>
 <p>
 The J-PAKE protocol is symmetric.
 There is no notion of a <i>client</i> or <i>server</i>, but rather just two <i>participants</i>.
 An instance of <a href="JPAKEParticipant.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake"><code>JPAKEParticipant</code></a> represents one participant, and
 is the primary interface for executing the exchange.
 <p>
 To execute an exchange, construct a <a href="JPAKEParticipant.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake"><code>JPAKEParticipant</code></a> on each end,
 and call the following 7 methods
 (once and only once, in the given order, for each participant, sending messages between them as described):
 <ol>
 <li><a href="#createRound1PayloadToSend()"><code>createRound1PayloadToSend()</code></a> - and send the payload to the other participant</li>
 <li><a href="#validateRound1PayloadReceived(com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKERound1Payload)"><code>validateRound1PayloadReceived(JPAKERound1Payload)</code></a> - use the payload received from the other participant</li>
 <li><a href="#createRound2PayloadToSend()"><code>createRound2PayloadToSend()</code></a> - and send the payload to the other participant</li>
 <li><a href="#validateRound2PayloadReceived(com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKERound2Payload)"><code>validateRound2PayloadReceived(JPAKERound2Payload)</code></a> - use the payload received from the other participant</li>
 <li><a href="#calculateKeyingMaterial()"><code>calculateKeyingMaterial()</code></a></li>
 <li><a href="#createRound3PayloadToSend(java.math.BigInteger)"><code>createRound3PayloadToSend(BigInteger)</code></a> - and send the payload to the other participant</li>
 <li><a href="#validateRound3PayloadReceived(com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKERound3Payload,java.math.BigInteger)"><code>validateRound3PayloadReceived(JPAKERound3Payload, BigInteger)</code></a> - use the payload received from the other participant</li>
 </ol>
 <p>
 Each side should derive a session key from the keying material returned by <a href="#calculateKeyingMaterial()"><code>calculateKeyingMaterial()</code></a>.
 The caller is responsible for deriving the session key using a secure key derivation function (KDF).
 <p>
 Round 3 is an optional key confirmation process.
 If you do not execute round 3, then there is no assurance that both participants are using the same key.
 (i.e. if the participants used different passwords, then their session keys will differ.)
 <p>
 If the round 3 validation succeeds, then the keys are guaranteed to be the same on both sides.
 <p>
 The symmetric design can easily support the asymmetric cases when one party initiates the communication.
 e.g. Sometimes the round1 payload and round2 payload may be sent in one pass.
 Also, in some cases, the key confirmation payload can be sent together with the round2 payload.
 These are the trivial techniques to optimize the communication.
 <p>
 The key confirmation process is implemented as specified in
 <a href="http://csrc.nist.gov/publications/nistpubs/800-56A/SP800-56A_Revision1_Mar08-2007.pdf">NIST SP 800-56A Revision 1</a>,
 Section 8.2 Unilateral Key Confirmation for Key Agreement Schemes.
 <p>
 This class is stateful and NOT threadsafe.
 Each instance should only be used for ONE complete J-PAKE exchange
 (i.e. a new <a href="JPAKEParticipant.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake"><code>JPAKEParticipant</code></a> should be constructed for each new J-PAKE exchange).
 <p></div>
</section>
<section class="summary">
<ul class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<li class="blockList">
<section class="fieldSummary"><a id="field.summary">
<!--   -->
</a>
<h2>Field Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#STATE_INITIALIZED">STATE_INITIALIZED</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#STATE_KEY_CALCULATED">STATE_KEY_CALCULATED</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#STATE_ROUND_1_CREATED">STATE_ROUND_1_CREATED</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#STATE_ROUND_1_VALIDATED">STATE_ROUND_1_VALIDATED</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#STATE_ROUND_2_CREATED">STATE_ROUND_2_CREATED</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#STATE_ROUND_2_VALIDATED">STATE_ROUND_2_VALIDATED</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#STATE_ROUND_3_CREATED">STATE_ROUND_3_CREATED</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#STATE_ROUND_3_VALIDATED">STATE_ROUND_3_VALIDATED</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li class="blockList">
<section class="constructorSummary"><a id="constructor.summary">
<!--   -->
</a>
<h2>Constructor Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(java.lang.String,char%5B%5D)">JPAKEParticipant</a></span>&#8203;(java.lang.String&nbsp;participantId,
char[]&nbsp;password)</code></th>
<td class="colLast">
<div class="block">Convenience constructor for a new <a href="JPAKEParticipant.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake"><code>JPAKEParticipant</code></a> that uses
 the <a href="JPAKEPrimeOrderGroups.html#NIST_3072"><code>JPAKEPrimeOrderGroups.NIST_3072</code></a> prime order group,
 a SHA-256 digest, and a default <code>SecureRandom</code> implementation.</div>
</td>
</tr>
<tr class="rowColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(java.lang.String,char%5B%5D,com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKEPrimeOrderGroup)">JPAKEParticipant</a></span>&#8203;(java.lang.String&nbsp;participantId,
char[]&nbsp;password,
<a href="JPAKEPrimeOrderGroup.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake">JPAKEPrimeOrderGroup</a>&nbsp;group)</code></th>
<td class="colLast">
<div class="block">Convenience constructor for a new <a href="JPAKEParticipant.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake"><code>JPAKEParticipant</code></a> that uses
 a SHA-256 digest and a default <code>SecureRandom</code> implementation.</div>
</td>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(java.lang.String,char%5B%5D,com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKEPrimeOrderGroup,com.distrimind.bouncycastle.crypto.Digest,java.security.SecureRandom)">JPAKEParticipant</a></span>&#8203;(java.lang.String&nbsp;participantId,
char[]&nbsp;password,
<a href="JPAKEPrimeOrderGroup.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake">JPAKEPrimeOrderGroup</a>&nbsp;group,
<a href="../../Digest.html" title="interface in com.distrimind.bouncycastle.crypto">Digest</a>&nbsp;digest,
java.security.SecureRandom&nbsp;random)</code></th>
<td class="colLast">
<div class="block">Construct a new <a href="JPAKEParticipant.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake"><code>JPAKEParticipant</code></a>.</div>
</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li class="blockList">
<section class="methodSummary"><a id="method.summary">
<!--   -->
</a>
<h2>Method Summary</h2>
<div class="memberSummary">
<div role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="memberSummary_tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="activeTableTab">All Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t2" class="tableTab" onclick="show(2);">Instance Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t4" class="tableTab" onclick="show(8);">Concrete Methods</button></div>
<div id="memberSummary_tabpanel" role="tabpanel">
<table aria-labelledby="t0">
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor" id="i0">
<td class="colFirst"><code>java.math.BigInteger</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#calculateKeyingMaterial()">calculateKeyingMaterial</a></span>()</code></th>
<td class="colLast">
<div class="block">Calculates and returns the key material.</div>
</td>
</tr>
<tr class="rowColor" id="i1">
<td class="colFirst"><code><a href="JPAKERound1Payload.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake">JPAKERound1Payload</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createRound1PayloadToSend()">createRound1PayloadToSend</a></span>()</code></th>
<td class="colLast">
<div class="block">Creates and returns the payload to send to the other participant during round 1.</div>
</td>
</tr>
<tr class="altColor" id="i2">
<td class="colFirst"><code><a href="JPAKERound2Payload.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake">JPAKERound2Payload</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createRound2PayloadToSend()">createRound2PayloadToSend</a></span>()</code></th>
<td class="colLast">
<div class="block">Creates and returns the payload to send to the other participant during round 2.</div>
</td>
</tr>
<tr class="rowColor" id="i3">
<td class="colFirst"><code><a href="JPAKERound3Payload.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake">JPAKERound3Payload</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createRound3PayloadToSend(java.math.BigInteger)">createRound3PayloadToSend</a></span>&#8203;(java.math.BigInteger&nbsp;keyingMaterial)</code></th>
<td class="colLast">
<div class="block">Creates and returns the payload to send to the other participant during round 3.</div>
</td>
</tr>
<tr class="altColor" id="i4">
<td class="colFirst"><code>int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getState()">getState</a></span>()</code></th>
<td class="colLast">
<div class="block">Gets the current state of this participant.</div>
</td>
</tr>
<tr class="rowColor" id="i5">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#validateRound1PayloadReceived(com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKERound1Payload)">validateRound1PayloadReceived</a></span>&#8203;(<a href="JPAKERound1Payload.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake">JPAKERound1Payload</a>&nbsp;round1PayloadReceived)</code></th>
<td class="colLast">
<div class="block">Validates the payload received from the other participant during round 1.</div>
</td>
</tr>
<tr class="altColor" id="i6">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#validateRound2PayloadReceived(com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKERound2Payload)">validateRound2PayloadReceived</a></span>&#8203;(<a href="JPAKERound2Payload.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake">JPAKERound2Payload</a>&nbsp;round2PayloadReceived)</code></th>
<td class="colLast">
<div class="block">Validates the payload received from the other participant during round 2.</div>
</td>
</tr>
<tr class="rowColor" id="i7">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#validateRound3PayloadReceived(com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKERound3Payload,java.math.BigInteger)">validateRound3PayloadReceived</a></span>&#8203;(<a href="JPAKERound3Payload.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake">JPAKERound3Payload</a>&nbsp;round3PayloadReceived,
java.math.BigInteger&nbsp;keyingMaterial)</code></th>
<td class="colLast">
<div class="block">Validates the payload received from the other participant during round 3.</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="inheritedList">
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a><code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<li class="blockList">
<section class="fieldDetails"><a id="field.detail">
<!--   -->
</a>
<h2>Field Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="STATE_INITIALIZED">STATE_INITIALIZED</a></h3>
<div class="memberSignature"><span class="modifiers">public static final</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">STATE_INITIALIZED</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKEParticipant.STATE_INITIALIZED">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="STATE_ROUND_1_CREATED">STATE_ROUND_1_CREATED</a></h3>
<div class="memberSignature"><span class="modifiers">public static final</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">STATE_ROUND_1_CREATED</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKEParticipant.STATE_ROUND_1_CREATED">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="STATE_ROUND_1_VALIDATED">STATE_ROUND_1_VALIDATED</a></h3>
<div class="memberSignature"><span class="modifiers">public static final</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">STATE_ROUND_1_VALIDATED</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKEParticipant.STATE_ROUND_1_VALIDATED">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="STATE_ROUND_2_CREATED">STATE_ROUND_2_CREATED</a></h3>
<div class="memberSignature"><span class="modifiers">public static final</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">STATE_ROUND_2_CREATED</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKEParticipant.STATE_ROUND_2_CREATED">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="STATE_ROUND_2_VALIDATED">STATE_ROUND_2_VALIDATED</a></h3>
<div class="memberSignature"><span class="modifiers">public static final</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">STATE_ROUND_2_VALIDATED</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKEParticipant.STATE_ROUND_2_VALIDATED">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="STATE_KEY_CALCULATED">STATE_KEY_CALCULATED</a></h3>
<div class="memberSignature"><span class="modifiers">public static final</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">STATE_KEY_CALCULATED</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKEParticipant.STATE_KEY_CALCULATED">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="STATE_ROUND_3_CREATED">STATE_ROUND_3_CREATED</a></h3>
<div class="memberSignature"><span class="modifiers">public static final</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">STATE_ROUND_3_CREATED</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKEParticipant.STATE_ROUND_3_CREATED">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="STATE_ROUND_3_VALIDATED">STATE_ROUND_3_VALIDATED</a></h3>
<div class="memberSignature"><span class="modifiers">public static final</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">STATE_ROUND_3_VALIDATED</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKEParticipant.STATE_ROUND_3_VALIDATED">Constant Field Values</a></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li class="blockList">
<section class="constructorDetails"><a id="constructor.detail">
<!--   -->
</a>
<h2>Constructor Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="&lt;init&gt;(java.lang.String,char[])">JPAKEParticipant</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="memberName">JPAKEParticipant</span>&#8203;(<span class="arguments">java.lang.String&nbsp;participantId,
char[]&nbsp;password)</span></div>
<div class="block">Convenience constructor for a new <a href="JPAKEParticipant.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake"><code>JPAKEParticipant</code></a> that uses
 the <a href="JPAKEPrimeOrderGroups.html#NIST_3072"><code>JPAKEPrimeOrderGroups.NIST_3072</code></a> prime order group,
 a SHA-256 digest, and a default <code>SecureRandom</code> implementation.
 <p>
 After construction, the <a href="#getState()"><code>state</code></a> will be  <a href="#STATE_INITIALIZED"><code>STATE_INITIALIZED</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>participantId</code> - unique identifier of this participant.
                      The two participants in the exchange must NOT share the same id.</dd>
<dd><code>password</code> - shared secret.
                      A defensive copy of this array is made (and cleared once <a href="#calculateKeyingMaterial()"><code>calculateKeyingMaterial()</code></a> is called).
                      Caller should clear the input password as soon as possible.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.NullPointerException</code> - if any argument is null</dd>
<dd><code>java.lang.IllegalArgumentException</code> - if password is empty</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="&lt;init&gt;(java.lang.String,char[],com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKEPrimeOrderGroup)">JPAKEParticipant</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="memberName">JPAKEParticipant</span>&#8203;(<span class="arguments">java.lang.String&nbsp;participantId,
char[]&nbsp;password,
<a href="JPAKEPrimeOrderGroup.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake">JPAKEPrimeOrderGroup</a>&nbsp;group)</span></div>
<div class="block">Convenience constructor for a new <a href="JPAKEParticipant.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake"><code>JPAKEParticipant</code></a> that uses
 a SHA-256 digest and a default <code>SecureRandom</code> implementation.
 <p>
 After construction, the <a href="#getState()"><code>state</code></a> will be  <a href="#STATE_INITIALIZED"><code>STATE_INITIALIZED</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>participantId</code> - unique identifier of this participant.
                      The two participants in the exchange must NOT share the same id.</dd>
<dd><code>password</code> - shared secret.
                      A defensive copy of this array is made (and cleared once <a href="#calculateKeyingMaterial()"><code>calculateKeyingMaterial()</code></a> is called).
                      Caller should clear the input password as soon as possible.</dd>
<dd><code>group</code> - prime order group.
                      See <a href="JPAKEPrimeOrderGroups.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake"><code>JPAKEPrimeOrderGroups</code></a> for standard groups</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.NullPointerException</code> - if any argument is null</dd>
<dd><code>java.lang.IllegalArgumentException</code> - if password is empty</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="&lt;init&gt;(java.lang.String,char[],com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKEPrimeOrderGroup,com.distrimind.bouncycastle.crypto.Digest,java.security.SecureRandom)">JPAKEParticipant</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="memberName">JPAKEParticipant</span>&#8203;(<span class="arguments">java.lang.String&nbsp;participantId,
char[]&nbsp;password,
<a href="JPAKEPrimeOrderGroup.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake">JPAKEPrimeOrderGroup</a>&nbsp;group,
<a href="../../Digest.html" title="interface in com.distrimind.bouncycastle.crypto">Digest</a>&nbsp;digest,
java.security.SecureRandom&nbsp;random)</span></div>
<div class="block">Construct a new <a href="JPAKEParticipant.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake"><code>JPAKEParticipant</code></a>.
 <p>
 After construction, the <a href="#getState()"><code>state</code></a> will be  <a href="#STATE_INITIALIZED"><code>STATE_INITIALIZED</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>participantId</code> - unique identifier of this participant.
                      The two participants in the exchange must NOT share the same id.</dd>
<dd><code>password</code> - shared secret.
                      A defensive copy of this array is made (and cleared once <a href="#calculateKeyingMaterial()"><code>calculateKeyingMaterial()</code></a> is called).
                      Caller should clear the input password as soon as possible.</dd>
<dd><code>group</code> - prime order group.
                      See <a href="JPAKEPrimeOrderGroups.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake"><code>JPAKEPrimeOrderGroups</code></a> for standard groups</dd>
<dd><code>digest</code> - digest to use during zero knowledge proofs and key confirmation (SHA-256 or stronger preferred)</dd>
<dd><code>random</code> - source of secure random data for x1 and x2, and for the zero knowledge proofs</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.NullPointerException</code> - if any argument is null</dd>
<dd><code>java.lang.IllegalArgumentException</code> - if password is empty</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li class="blockList">
<section class="methodDetails"><a id="method.detail">
<!--   -->
</a>
<h2>Method Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="getState()">getState</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">getState</span>()</div>
<div class="block">Gets the current state of this participant.
 See the <tt>STATE_*</tt> constants for possible values.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="createRound1PayloadToSend()">createRound1PayloadToSend</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="JPAKERound1Payload.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake">JPAKERound1Payload</a></span>&nbsp;<span class="memberName">createRound1PayloadToSend</span>()</div>
<div class="block">Creates and returns the payload to send to the other participant during round 1.
 <p>
 After execution, the <a href="#getState()"><code>state</code></a> will be  <a href="#STATE_ROUND_1_CREATED"><code>STATE_ROUND_1_CREATED</code></a>.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="validateRound1PayloadReceived(com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKERound1Payload)">validateRound1PayloadReceived</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">validateRound1PayloadReceived</span>&#8203;(<span class="arguments"><a href="JPAKERound1Payload.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake">JPAKERound1Payload</a>&nbsp;round1PayloadReceived)</span>
                                   throws <span class="exceptions"><a href="../../CryptoException.html" title="class in com.distrimind.bouncycastle.crypto">CryptoException</a></span></div>
<div class="block">Validates the payload received from the other participant during round 1.
 <p>
 Must be called prior to <a href="#createRound2PayloadToSend()"><code>createRound2PayloadToSend()</code></a>.
 <p>
 After execution, the <a href="#getState()"><code>state</code></a> will be  <a href="#STATE_ROUND_1_VALIDATED"><code>STATE_ROUND_1_VALIDATED</code></a>.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../CryptoException.html" title="class in com.distrimind.bouncycastle.crypto">CryptoException</a></code> - if validation fails.</dd>
<dd><code>java.lang.IllegalStateException</code> - if called multiple times.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="createRound2PayloadToSend()">createRound2PayloadToSend</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="JPAKERound2Payload.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake">JPAKERound2Payload</a></span>&nbsp;<span class="memberName">createRound2PayloadToSend</span>()</div>
<div class="block">Creates and returns the payload to send to the other participant during round 2.
 <p>
 <a href="#validateRound1PayloadReceived(com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKERound1Payload)"><code>validateRound1PayloadReceived(JPAKERound1Payload)</code></a> must be called prior to this method.
 <p>
 After execution, the <a href="#getState()"><code>state</code></a> will be  <a href="#STATE_ROUND_2_CREATED"><code>STATE_ROUND_2_CREATED</code></a>.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if called prior to <a href="#validateRound1PayloadReceived(com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKERound1Payload)"><code>validateRound1PayloadReceived(JPAKERound1Payload)</code></a>, or multiple times</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="validateRound2PayloadReceived(com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKERound2Payload)">validateRound2PayloadReceived</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">validateRound2PayloadReceived</span>&#8203;(<span class="arguments"><a href="JPAKERound2Payload.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake">JPAKERound2Payload</a>&nbsp;round2PayloadReceived)</span>
                                   throws <span class="exceptions"><a href="../../CryptoException.html" title="class in com.distrimind.bouncycastle.crypto">CryptoException</a></span></div>
<div class="block">Validates the payload received from the other participant during round 2.
 <p>
 Note that this DOES NOT detect a non-common password.
 The only indication of a non-common password is through derivation
 of different keys (which can be detected explicitly by executing round 3 and round 4)
 <p>
 Must be called prior to <a href="#calculateKeyingMaterial()"><code>calculateKeyingMaterial()</code></a>.
 <p>
 After execution, the <a href="#getState()"><code>state</code></a> will be  <a href="#STATE_ROUND_2_VALIDATED"><code>STATE_ROUND_2_VALIDATED</code></a>.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../CryptoException.html" title="class in com.distrimind.bouncycastle.crypto">CryptoException</a></code> - if validation fails.</dd>
<dd><code>java.lang.IllegalStateException</code> - if called prior to <a href="#validateRound1PayloadReceived(com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKERound1Payload)"><code>validateRound1PayloadReceived(JPAKERound1Payload)</code></a>, or multiple times</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="calculateKeyingMaterial()">calculateKeyingMaterial</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.math.BigInteger</span>&nbsp;<span class="memberName">calculateKeyingMaterial</span>()</div>
<div class="block">Calculates and returns the key material.
 A session key must be derived from this key material using a secure key derivation function (KDF).
 The KDF used to derive the key is handled externally (i.e. not by <a href="JPAKEParticipant.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake"><code>JPAKEParticipant</code></a>).
 <p>
 The keying material will be identical for each participant if and only if
 each participant's password is the same.  i.e. If the participants do not
 share the same password, then each participant will derive a different key.
 Therefore, if you immediately start using a key derived from
 the keying material, then you must handle detection of incorrect keys.
 If you want to handle this detection explicitly, you can optionally perform
 rounds 3 and 4.  See <a href="JPAKEParticipant.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake"><code>JPAKEParticipant</code></a> for details on how to execute
 rounds 3 and 4.
 <p>
 The keying material will be in the range <tt>[0, p-1]</tt>.
 <p>
 <a href="#validateRound2PayloadReceived(com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKERound2Payload)"><code>validateRound2PayloadReceived(JPAKERound2Payload)</code></a> must be called prior to this method.
 <p>
 As a side effect, the internal <code>password</code> array is cleared, since it is no longer needed.
 <p>
 After execution, the <a href="#getState()"><code>state</code></a> will be  <a href="#STATE_KEY_CALCULATED"><code>STATE_KEY_CALCULATED</code></a>.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if called prior to <a href="#validateRound2PayloadReceived(com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKERound2Payload)"><code>validateRound2PayloadReceived(JPAKERound2Payload)</code></a>,
 or if called multiple times.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="createRound3PayloadToSend(java.math.BigInteger)">createRound3PayloadToSend</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="JPAKERound3Payload.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake">JPAKERound3Payload</a></span>&nbsp;<span class="memberName">createRound3PayloadToSend</span>&#8203;(<span class="arguments">java.math.BigInteger&nbsp;keyingMaterial)</span></div>
<div class="block">Creates and returns the payload to send to the other participant during round 3.
 <p>
 See <a href="JPAKEParticipant.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake"><code>JPAKEParticipant</code></a> for more details on round 3.
 <p>
 After execution, the <a href="#getState()"><code>state</code></a> will be  <a href="#STATE_ROUND_3_CREATED"><code>STATE_ROUND_3_CREATED</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>keyingMaterial</code> - The keying material as returned from <a href="#calculateKeyingMaterial()"><code>calculateKeyingMaterial()</code></a>.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if called prior to <a href="#calculateKeyingMaterial()"><code>calculateKeyingMaterial()</code></a>, or multiple times</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="validateRound3PayloadReceived(com.distrimind.bouncycastle.crypto.agreement.jpake.JPAKERound3Payload,java.math.BigInteger)">validateRound3PayloadReceived</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">validateRound3PayloadReceived</span>&#8203;(<span class="arguments"><a href="JPAKERound3Payload.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake">JPAKERound3Payload</a>&nbsp;round3PayloadReceived,
java.math.BigInteger&nbsp;keyingMaterial)</span>
                                   throws <span class="exceptions"><a href="../../CryptoException.html" title="class in com.distrimind.bouncycastle.crypto">CryptoException</a></span></div>
<div class="block">Validates the payload received from the other participant during round 3.
 <p>
 See <a href="JPAKEParticipant.html" title="class in com.distrimind.bouncycastle.crypto.agreement.jpake"><code>JPAKEParticipant</code></a> for more details on round 3.
 <p>
 After execution, the <a href="#getState()"><code>state</code></a> will be <a href="#STATE_ROUND_3_VALIDATED"><code>STATE_ROUND_3_VALIDATED</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>round3PayloadReceived</code> - The round 3 payload received from the other participant.</dd>
<dd><code>keyingMaterial</code> - The keying material as returned from <a href="#calculateKeyingMaterial()"><code>calculateKeyingMaterial()</code></a>.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../CryptoException.html" title="class in com.distrimind.bouncycastle.crypto">CryptoException</a></code> - if validation fails.</dd>
<dd><code>java.lang.IllegalStateException</code> - if called prior to <a href="#calculateKeyingMaterial()"><code>calculateKeyingMaterial()</code></a>, or multiple times</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</body>
</html>
